# Vulnerability types {#concept_afk_gsy_wdb .concept}

This article introduces common security vulnerabilities for web servers and clients.

**Security vulnerabilities for web servers**

## SQL injection attacks {#section_fdq_hsy_wdb .section}

An SQL injection attack \(also known as injection attack or SQL injection\) attempts to obtain control over websites maliciously. It is a security vulnerability that occurs at the database level of applications. The program code does not check for SQL commands contained in users' input strings. The database mistakes the attack commands as regular SQL commands, allowing the database to be attacked. The attack can lead to the theft, tampering, and deletion of data, and it can execute system commands. This further causes the site to be embedded with malicious code, and implanted with backdoor programs.

**Common scenarios**

-   URL parameter submission, mainly GET request parameters.
-   Form submission, mainly POST and GET requests.
-   Cookie parameter submission.
-   Modifiable values in the HTTP request header, such as Referer and User\_Agent.
-   Peripheral input parameters, such as MP3 files and the file information of image files.

**Defense methods**

-   **Use precompiled statements**: In general, the best way to defend against SQL injection is to use precompiled statements to bind the variables. This requires changes to the existing code.
-   **Use stored procedures**: The use of secure stored procedures can prevent SQL injection. However, this method does not guarantee full security.
-   **Check user data**: Check the data type and content entered by users. For example, you need to check the data type. When you perform a query by ID, you have to check whether the entered ID is an integer. Check whether the mailbox entered follows the mailbox format. Time and date values must be entered strictly following the time and date format. For data content, check whether the user submission data contains certain keywords or strings, and check whether it matches certain injection rules. Make sure that you escape all special characters. Even though this method is easy to implement, it is prone to false positives and false negatives, and it is easily bypassed.
-   **Other methods**: Use secure encoding functions, ensure consistency in the data-layer encoding formats \(such as always using the UTF-8 format\), restrict user access to the database, conduct regular black box and white box scans of code, and avoid displaying backend error messages on the page.

## File upload {#section_idq_hsy_wdb .section}

The program code does not strictly analyze and check the files submitted by the user. As a result, the attacker can upload executable code files to obtain the control \(Getshell\) of web applications.

**Common scenarios**

-   All scenarios involving the use of the upload function.
-   Customizable profile pictures and background images.
-   The upload function in rich-text editor.

**Defense methods**

-   Set the upload directory to not be executed.
-   Set the upload directory as not executable Check the file type. Use a whitelist instead of a blacklist. Make sure the capitalization is correct. Pay attention to issues related to vulnerabilities found on web servers, such as the file parsing vulnerabilities on Apache, IIS, and Nginx web servers.
-   Use random numbers to modify the uploaded file names and file paths.
-   Set up a separate file server and domain name.

## Access vulnerability {#section_ldq_hsy_wdb .section}

Access control is the granting of access and certain privileges to systems, resources or information for users. This usually includes horizontal access and vertical access. Access control problems are a logical vulnerability that may be generated by all business systems. It is difficult to scan or obtain protection using average security tools. Access control issues often result in the leakage of large amounts of user data.

-   **Horizontal privilege escalation**: Issues related to users having the same access level. For example, user A can gain access to the data of user B without authorization.
-   **Vertical privilege escalation**: Issues related to users having different access levels. For example, users with lower level access can perform management operations without authorization; users who are not logged on can access applications that require authorization.

**Common scenarios**

-   All scenarios involving user-related data, such as user data, addresses, and orders.
-   All scenarios involving logon and access control, such as background logon and current user access check.

**Defense methods**

-   For all operations related to user data, check the identity of the current user.
-   For all scenarios in which access control is required, check the user access level.

## Brute-force {#section_pdq_hsy_wdb .section}

The attacker sends a large number of requests to the target using the traversal or dictionary attack. The attacker identifies the correct authentication information by judging the characteristics of the returned data packet. The verification system is bypassed as a result. In addition, attackers can use data stolen from the databases of many websites to narrow down the samples and have a higher chance of brute-force cracking the passwords.

**Common scenarios**

-   The account and password on the user logon page.
-   The CAPTCHA system is easy to bypass, especially when a more easily identifiable verification code is used.
-   Text message verification codes such as those for password reset or for two-factor verification purposes.

**Defense methods**

-   Use a strong password, and change it regularly.
-   Limit the number of failed logon attempts.
-   Use CAPTCHA.
-   Limit the access frequency during a certain period of time.

## Denial of service attack {#section_sdq_hsy_wdb .section}

A denial-of-service \(DoS\) attack floods incomming traffic to overload network resources, making them unavailable to their intended users. This can be divided into attacks against web applications and attacks against the clients or mobile applications. The attack.

**Common scenarios**

-   For web applications, DoS attacks are common in scenarios that consume large amounts of resources, such as lookups.
-   For clients and mobile applications, DoS attacks are initiated using malicious parameters that result in program crashes.

**Defense methods**

**DoS attacks against web applications**

-   Limit the request frequency of each client.
-   Use CAPTCHA.
-   Optimize code performance and network architecture for the application.

**DoS attacks against clients and mobile applications** 

-   Delete unnecessary components.
-   Filter and check the data entered by users.

## Sensitive information leakage {#section_xdq_hsy_wdb .section}

Attackers exploit websites, interfaces, and external storage components to obtain user information, employee information, internal data, and other data. This vulnerability can result in the leakage of massive amounts of user and company information, which is used to attempt fraud and account theft, harming users and businesses. Once the information has been leaked, mitigating the negative impacts is difficult.

**Common scenarios**

-   Websites and client interfaces that obtain user and company information.
-   External storage components such as cloud storage and mailbox, which may be accessed by the company.
-   All other channels that may leak data.

**Defense methods**

Check and control the access to data interfaces. Define the security boundary of the company; prohibit the outflow of internal data, for example, by restricting access to external storage. Train employees on data security.

## Business logic vulnerability {#section_a2q_hsy_wdb .section}

It is a process or logic vulnerability caused by a flaw in the application. For example, the attacker can reset any user password by exploiting the password reset vulnerability. The attacker can also maliciously increase costs for the company and harass its users by sending unauthorized text messages through the interface. Business logic loopholes are closely related to business operations. Therefore, regular security programs cannot detect these vulnerabilities. Human intervention is required to examine the business scenarios and identify vulnerabilities.

**Common scenarios**

-   All scenarios involving interaction with users.

**Defense methods**

-   Fully examine the business scenarios.

## Security configuration flaws {#section_d2q_hsy_wdb .section}

This includes file traversal, source code leakage, and configuration file leakage.

-   **File traversal**: The files under the web directory of the server may be browsed by the attacker, causing important files to be leaked.
-   **Source code leakage**: The source code of the web application may be leaked.
-   **Configuration file leakage**: The configuration files for the web server and for the program code may be leaked.

**Defense methods**

-   Check for all security configuration risks. Optimize the security configuration while satisfying business demands.

**Security vulnerabilities for web clients**

## Cross-site scripting \(XSS\) attacks {#section_g2q_hsy_wdb .section}

The attacker injects malicious scripts and changes the website using HTML injection. The attacker hijacks the browser when the user browses the webpage affected by cross-site scripting. XSS Attackers exploit this vulnerability to steal identities \(especially targeting administrators\), hijack user operations, and initiate Trojan, worm, and phishing attacks. The XSS attack is a key vulnerability for clients.

The XSS attacks include three types based on their effects.

-   **Reflected XSS**: The webpage displays input made by users in the source code of the webpage. To make the attack effective, the attacker has to lure the user into opening on the webpage.
-   **Stored XSS**: The XSS attack code is stored in the server. This type of attack causes more damage because the user may actively browse the compromised webpage.
-   **DOM-based XSS**: The DOM nodes of the webpage are modified.

**Common scenarios**

-   All user-controllable input and output parameters, such as personal information, articles, and comments.

**Defense methods**

-   Use HttpOnly parameters in key cookie fields.
-   Check all user-controllable inputs. Check all input parameters. Filter or intercept inputs that do not match the context. Since not all output contexts can be listed, the effect of this method is relatively poor.
-   Check all output parameters of input made by users. Because the XSS attack occurs at the output parameters, we need to analyze the environment of all output parameters for input made by users. Check the following parameters: HTML labels, HTML attributes, script labels, events, and CSS. Create different escape or filter rules based on different output parameters.
-   Process rich texts. Distinguish rich texts from cross-site scripting in scenarios that use rich texts, such as forum posts. Prohibit all HTML syntax labels and "js events." Use whitelists to filter labels, events, and attributes.

## Cross-site request forgery \(CSRF\) {#section_k2q_hsy_wdb .section}

Cross-site request forgery \(CSRF\). Forgery \). Because all the parameters for key operations can be guessed, the attacker can forge requests with the user's identity. The attacker may publish articles, purchase items, make payments, modify data, and change passwords.

**Common locations**

-   All operations initiated by the users and the administrators.

**Defense methods** 

-   Use verification codes. They are the most effective method to combat the CSRF attacks. However, they may also have an impact on user experience. Additionally, not all operations can be protected by verification codes. As a result, verification codes can only be used as a secondary verification method.
-   Add random CSRF tokens and update frequently. This can prevent the parameters from being guessed. CSRF tokens are now a common defense method.
-   Verify HTTP Referer and refuse insecure sources. However, the server may not always obtain the Referer value.

**Note:** We recommend that you use a combination of the three methods to make your defense more effective.

